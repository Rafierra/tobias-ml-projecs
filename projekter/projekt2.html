<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <title>Learning Physics from Data: A Visual Introduction to DMD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body { font-family: Georgia, serif; line-height: 1.6; }
    code { background: #f4f4f4; padding: 2px 4px; }
    pre { background: #f9f9f9; padding: 1rem; overflow-x: auto; }
    blockquote { border-left: 3px solid #ccc; padding-left: 1rem; color: #555; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

<header class="bg-white shadow-md">
  <div class="max-w-6xl mx-auto flex items-center justify-between p-6">
    <div class="flex items-center space-x-4">
      <a href="../index.html">
        <img src="../assets/tobias.jpg" alt="Tobias Sjögreen" class="w-16 h-16 rounded-full border-2 border-gray-300">
      </a>
      <div>
        <h1 class="text-xl font-bold">Tobias Sjögreen</h1>
        <p class="text-sm text-gray-600">Anvendt Matematiker · Applied Mathematician</p>
      </div>
    </div>
    <div class="space-x-4">
      <a href="cv.html" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">CV / Resume</a>
    </div>
  </div>
</header>

<main class="max-w-3xl mx-auto py-10 px-4 bg-white rounded shadow">
  <a href="../index.html" class="text-blue-600 hover:underline mb-4 inline-block">&larr; Back to the Front Page</a>

  <section id="dmd-blobs">
    <h1>Dynamic Mode Decomposition (DMD) – A Visual Introduction</h1>

    <p>
      Dynamic Mode Decomposition (DMD) is a powerful technique for analyzing high-dimensional time series data by decomposing it into coherent spatiotemporal modes. It provides a linear approximation of nonlinear dynamics by identifying the modes that describe how the system evolves in time.
    </p>

    <p>
      To illustrate the power of DMD, we construct a synthetic dataset consisting of two <strong>oscillating Gaussian blobs</strong> blinking at different frequencies in a 2D grid. The result is a spatiotemporal signal that varies smoothly in both space and time, making it ideal for modal decomposition.
    </p>

    <h3>Data Generation</h3>
    <p>
      We define two Gaussian blobs located at different centers in a 2D plane. One blob oscillates slowly, and the other more rapidly. The full dataset is a sequence of frames over time: \( X(t) \in \mathbb{R}^{n_x \times n_y} \), reshaped into a matrix \( X \in \mathbb{R}^{n \times T} \), where each column is a vectorized frame at time \( t \).
    </p>

    <h3>DMD Algorithm Overview</h3>
    <p>
      The DMD method approximates the time evolution of the system as:
      \[
      X' \approx A X
      \]
      where \( A \) is the unknown linear operator. To find a low-rank approximation of \( A \), we proceed through the following steps:
    </p>

    <ol>
      <li>Split the data matrix into two: \( X = [x_0, x_1, ..., x_{T-1}] \) and \( X' = [x_1, x_2, ..., x_T] \)</li>
      <li>Apply Singular Value Decomposition (SVD): \( X = U \Sigma V^* \)</li>
      <li>Truncate to rank \( r \) to get \( U_r, \Sigma_r, V_r \)</li>
      <li>Construct reduced system: \( \tilde{A} = U_r^T X' V_r \Sigma_r^{-1} \)</li>
      <li>Compute eigenvalues and eigenvectors of \( \tilde{A} \): \( \tilde{A} W = W \Lambda \)</li>
      <li>Project back to high-dimensional space: \( \Phi = X' V_r \Sigma_r^{-1} W \)</li>
    </ol>

    <p>
      The columns of \( \Phi \) are the DMD modes, and the eigenvalues \( \lambda_i \) determine their growth/decay and oscillation over time:
      \[
      x(t) = \sum_{i=1}^r b_i \phi_i e^{\omega_i t}, \quad \omega_i = \log(\lambda_i)
      \]
      where \( b \) is computed by projecting the initial state onto the mode basis.
    </p>

    <h3>Results and Visualization</h3>
    <p>
      After applying DMD, we analyze several outputs:
    </p>

    <ul>
      <li><strong>DMD Eigenvalues:</strong> plotted in the complex plane. Eigenvalues near the unit circle represent sustained oscillations; those inside decay over time.</li>
      <li><strong>Mode Amplitudes:</strong> the magnitude of \( b_i \) indicates the importance of each mode.</li>
      <li><strong>Reconstructed Frames:</strong> comparing original data with the DMD reconstruction shows how well the linear model captures the dynamics.</li>
      <li><strong>Mode Shapes:</strong> DMD modes represent spatial structures in the signal that persist and evolve over time.</li>
      <li><strong>Temporal Dynamics:</strong> plotting \( |b_i e^{\omega_i t}| \) over time reveals how each mode behaves — oscillating, growing, or decaying.</li>
    </ul>

    <h3>Selected Visualizations</h3>

    <p>
      The plot below shows the eigenvalues in the complex plane:
    </p>
    <img src="../assets/eigenvalues_blob.png" alt="DMD Eigenvalues" style="max-width: 100%;">

    <p>
      Below are the amplitudes of each mode, showing which components dominate the signal:
    </p>
    <img src="../assets/Amplitude_blob.png" alt="DMD Mode Amplitudes" style="max-width: 100%;">

    <p>
      A side-by-side comparison of an original frame and its DMD reconstruction:
    </p>
    <img src="../assets/Reconstructed_blob.png" alt="Original vs DMD Reconstructed Frame" style="max-width: 100%;">

    <p>
      The first 10 DMD spatial modes are shown below:
    </p>
    <img src="../assets/modes_blob.png" alt="DMD Spatial Modes" style="max-width: 100%;">

    <p>
      Finally, we visualize how the five dominant modes evolve in time:
    </p>
    <img src="../assets/dynamics_modes.png" alt="DMD Temporal Dynamics" style="max-width: 100%;">

    <h3>Conclusion</h3>
    <p>
      DMD successfully separates the complex oscillatory pattern of the blinking blobs into distinct spatiotemporal modes, each associated with a specific frequency and growth/decay behavior. This example demonstrates how DMD can reveal hidden low-rank dynamics in high-dimensional data and forms the basis for more advanced applications in fluid dynamics, neuroscience, finance, and video compression.
    </p>
  </section>

  <section id="dmd-flip-analysis">
    <h2>Analyzing FLIP Dynamics Using DMD</h2>

    <p>
      After simulating our synthetic FLIP dataset, we apply <strong>Dynamic Mode Decomposition (DMD)</strong> to extract spatial and temporal structures that underlie the observed fluorescence decay. DMD is particularly suitable here because it decomposes the data into low-rank components that capture coherent spatiotemporal patterns — even in noisy, nonlinear systems.
    </p>

    <img src="../assets/simulated_cell.png" alt="DMD Modes of FLIP Simulation" style="max-width: 100%;">
    <p>
      First, we reshape the data from a 3D array of shape \( (T, H, W) \) into a 2D matrix \( X \in \mathbb{R}^{n \times T} \), where each column is a vectorized image at a given time. This is a standard preprocessing step before applying DMD.
    </p>

    <p>
      We then apply classical DMD using a fixed <code>svd_rank=3</code>, which enforces a low-rank approximation by retaining only the three most energetic dynamic components. The output consists of:
      <ul>
        <li><strong>Modes:</strong> spatial structures \( \phi_i \) showing where patterns emerge</li>
        <li><strong>Eigenvalues:</strong> \( \lambda_i \), which determine the temporal behavior of each mode</li>
        <li><strong>Reconstruction:</strong> an approximation of the original data using only these three dynamic components</li>
      </ul>
    </p>

    <p>
      Each mode can be interpreted as a spatial "footprint" of a process in the cell. For example:
      <ul>
        <li>Mode 0 might represent a slow, global bleaching trend in the cytoplasm</li>
        <li>Mode 1 could capture the more rapid decay near the nucleus, due to intercompartmental exchange</li>
        <li>Mode 2 might highlight localized retention in regions like an aggregate (if present)</li>
      </ul>
      These patterns are visualized below:
    </p>

    <img src="../assets/simulated_cell_modes.png" alt="DMD Modes of FLIP Simulation" style="max-width: 100%;">

    <p>
      We also inspect the <strong>DMD eigenvalues</strong> in the complex plane. Each eigenvalue \( \lambda_i \) is mapped to a continuous-time growth/decay rate via:
      \[
      \omega_i = \frac{\log(\lambda_i)}{\Delta t}
      \]
      where \( \Delta t \) is the time between frames. Eigenvalues near the unit circle indicate sustained or oscillatory dynamics; those inside decay over time. The presence of multiple eigenvalues with real parts close to zero but slightly negative indicates slow decay, consistent with gradual fluorescence loss in the cytoplasm.
    </p>

    <img src="../assets/eigenvalues_simulated_cell.png" alt="DMD Eigenvalues" style="max-width: 100%;">

    <p>
      Overall, the DMD analysis reveals that even in a relatively simple two- or three-compartment system, the resulting fluorescence evolution is composed of spatially distinct and temporally coupled components. This decomposition allows us to identify features that are not immediately visible in raw intensity data, such as:
      <ul>
        <li>Hidden boundaries between compartments (e.g., nucleus and aggregate)</li>
        <li>Rates of exchange between them (via eigenvalue magnitude)</li>
        <li>Stability or permanence of structures (e.g., modes that remain constant)</li>
      </ul>
    </p>

    <p>
      This approach lays the foundation for using DMD (and related modal decompositions) in live-cell imaging and fluorescence recovery/decay studies, where understanding transport, exchange, and binding is essential.
    </p>
  </section>

  <section id="flip-eigenvalue-analysis">
    <h2>Eigenvalue Analysis of the FLIP Model</h2>

    <p>
      To better understand the temporal behavior of the FLIP system, we compute the <strong>continuous-time eigenvalues</strong> of the governing differential equations. These eigenvalues describe the intrinsic dynamics of the system and give insight into stability, timescales, and interactions between compartments.
    </p>

    <p>
      The system is described by a set of first-order ODEs modeling the exchange and bleaching of fluorescence in the cytoplasm (\( F_c \)), nucleus (\( F_n \)), and optionally an aggregate (\( F_a \)). The linearized dynamics take the form:
      \[
      \frac{d\mathbf{F}}{dt} = A \mathbf{F}
      \]
      where \( A \) is the Jacobian matrix evaluated at the system's operating point (in this case, the full system since the model is linear).
    </p>

    <h3>Without Aggregate</h3>
    <p>
      The reduced 2D system is:
      \[
      \frac{dF_c}{dt} = k_1 F_n - k_2 F_c - \beta F_c \\
      \frac{dF_n}{dt} = -k_1 F_n + k_2 F_c
      \]
      Using symbolic computation, the Jacobian becomes:
      \[
      A = \begin{bmatrix}
      -k_2 - \beta & k_1 \\
      k_2 & -k_1
      \end{bmatrix}
      \]
      For the parameter values \( k_1 = 0.025, k_2 = 0.15, \beta = 0.05 \), we obtain:
      \[
      A = \begin{bmatrix}
      -0.2 & 0.025 \\
      0.15 & -0.025
      \end{bmatrix}
      \]
      The eigenvalues of this system are:
      \[
      \lambda_1 \approx -0.2193, \quad \lambda_2 \approx -0.0057
      \]
      Both are negative real numbers, indicating two modes with exponential decay. One decays quickly (short timescale), and the other very slowly (long timescale), which aligns with fluorescence loss dominated by cytoplasmic bleaching and nuclear replenishment.
    </p>

    <h3>With Aggregate</h3>
    <p>
      Including an aggregate introduces a third compartment:
      \[
      \frac{dF_a}{dt} = k_3 F_c - k_4 F_a
      \]
      leading to a 3D system with Jacobian:
      \[
      A = \begin{bmatrix}
      -k_2 - \beta - k_3 & k_1 & k_4 \\
      k_2 & -k_1 & 0 \\
      k_3 & 0 & -k_4
      \end{bmatrix}
      \]
      With the values \( k_3 = k_4 = 0.01 \), the numeric matrix becomes:
      \[
      A = \begin{bmatrix}
      -0.21 & 0.025 & 0.01 \\
      0.15 & -0.025 & 0 \\
      0.01 & 0 & -0.01
      \end{bmatrix}
      \]
      The eigenvalues here are:
      \[
      \lambda_1 \approx -0.2289, \quad \lambda_2 \approx -0.0113, \quad \lambda_3 \approx -0.0048
      \]
      All are real and negative, again indicating exponential decay. Compared to the 2D system, the presence of an aggregate introduces a new, very slow mode (\( \lambda_3 \)) which reflects the slow exchange with the aggregate. This matches intuition: fluorescence is temporarily "stored" in the aggregate, then released slowly, creating long-lived dynamics in the data.
    </p>

    <h3>Comparison with DMD Results</h3>
    <p>
      The eigenvalues obtained through symbolic analysis of the continuous system serve as a ground truth reference. When we perform DMD on the simulated fluorescence data, the eigenvalues estimated from the temporal evolution matrix \( \tilde{A} \) should approximate the exponentiated form:
      \[
      \lambda_{\text{DMD}} \approx e^{\omega_i \Delta t}
      \]
      where \( \omega_i \) are the continuous eigenvalues and \( \Delta t \) is the timestep. By applying:
      \[
      \omega_i = \frac{\log(\lambda_{\text{DMD}})}{\Delta t}
      \]
      we can directly compare the DMD-estimated dynamics to the theoretical continuous system. In our case, the DMD eigenvalues cluster near:
      <ul>
        <li>−0.22 (fast decay)</li>
        <li>−0.01 (slow exchange)</li>
        <li>Optional: −0.004 (aggregate dynamics)</li>
      </ul>
      which is a strong indication that DMD is capturing the true underlying dynamic structure.
    </p>

    <p>
      This validates both our simulation and the use of DMD as a powerful tool for revealing hidden dynamical mechanisms in biological transport systems, including fluorescence-based assays like FLIP.
    </p>
  </section>

  <section id="dmd-real-data">
    <h2>Applying DMD to Experimental FLIP Data</h2>

    <p>
      As a final step, we apply <strong>Dynamic Mode Decomposition</strong> to a real FLIP experiment. The input is a multi-frame <code>.tif</code> video capturing the fluorescence decay over time in a living cell. This experiment includes photobleaching of a region and tracks how fluorescence redistributes across the cell, revealing transport dynamics.
    </p>

    <p>
      The video is converted into a 3D array of shape \( (T, H, W) \), then reshaped into a 2D matrix \( X \in \mathbb{R}^{n \times T} \) where each column represents a frame. We then run DMD using:
      <pre><code>DMD(svd_rank=0)</code></pre>
      which selects all meaningful singular values to capture the full rank of the system.
    </p>

    <img src="../assets/real_cell_modes.png" alt="DMD Modes of FLIP Simulation" style="max-width: 100%;">


    <img src="../assets/eigenvalues_real_cell.png" alt="DMD Modes of FLIP Simulation" style="max-width: 100%;">
    <h3>Interpreting the Eigenvalues</h3>

    <p>
      The eigenvalues of the low-dimensional linear operator \( \tilde{A} \) give insight into the timescales and behavior of each dynamic component. For this dataset, the eigenvalues are:
      \[
      \lambda_1 \approx -0.0027,\quad \lambda_2 \approx -0.298,\quad \lambda_3 = \lambda_4 \approx -0.186
      \]
      These are all <strong>real and negative</strong>, indicating purely decaying modes — as expected in FLIP experiments, where fluorescence generally decays over time due to photobleaching and irreversible binding or sequestration.
    </p>

    <ul>
      <li>
        <strong>\( \lambda_2 \) and \( \lambda_3 \):</strong> Rapid decay (short timescale); likely representing the bleached region and immediate surroundings where signal is lost quickly.
      </li>
      <li>
        <strong>\( \lambda_1 \):</strong> Very slow decay; possibly related to a stable or insulated region (e.g., nuclear core, aggregates) that loses fluorescence more gradually or maintains higher intensity longer.
      </li>
    </ul>

    <h3>Interpreting the Modes</h3>

    <p>
      Each mode corresponds to a spatial pattern associated with one of the eigenvalues. By reshaping the modes back to the \( (H, W) \) format, we visualize where in the cell each dynamic component is most active. For instance:
      <ul>
        <li>Modes with uniform decay might correspond to cytoplasmic bleaching.</li>
        <li>Localized modes could indicate barriers, aggregates, or slow-exchange compartments.</li>
        <li>Overlapping modes show coupled dynamics, such as transport between nucleus and cytoplasm.</li>
      </ul>
    </p>

    <p>
      Taken together, the modes and eigenvalues provide a compact yet highly informative representation of the underlying biology. DMD allows us to separate distinct spatial dynamics and assign each its own timescale — a major advantage over traditional region-based quantification.
    </p>

    <p>
      Most importantly, the eigenvalue magnitudes and multiplicity indicate the <strong>complexity</strong> of the transport dynamics: multiple similar eigenvalues (here, around −0.18) suggest redundancy or symmetry in spatial decay patterns, while distinct eigenvalues with widely varying decay rates suggest compartmentalization or sequestration phenomena.
    </p>

    <p>
      This approach demonstrates that even with noisy, real-world data, DMD can robustly extract mechanistic insight. Future work might involve:
      <ul>
        <li>Comparing DMD results across multiple cells or conditions</li>
        <li>Tracking how eigenvalues shift with drug treatment or genetic perturbations</li>
        <li>Correlating DMD modes with known subcellular structures</li>
      </ul>
    </p>
  </section>





  <hr class="my-8">
  <h2 class="text-xl font-semibold mt-8 mb-2">References</h2>
  <ol class="list-decimal ml-6">
    <li>Schmid, P. J. (2010). <em>Dynamic mode decomposition of numerical and experimental data</em>. Journal of Fluid Mechanics, 656, 5–28.</li>
    <li>Kutz, J. N., et al. (2016). <em>Dynamic Mode Decomposition: Data-Driven Modeling of Complex Systems</em>. SIAM.</li>
    <li>Brunton, S. L., & Kutz, J. N. (2022). <em>Data-Driven Science & Engineering</em>. Cambridge University Press.</li>
    <li><strong>pyDMD GitHub:</strong> <a href="https://github.com/mathLab/PyDMD">https://github.com/mathLab/PyDMD</a></li>
    <li><strong>DMD in Cell Biology:</strong> Michalopoulou, A. et al. (2022). <em>DMD analysis of protein transport using FLIP microscopy</em>. Sensors 22(18), 4731.</li>
  </ol>
</main>

<footer class="bg-white border-t mt-12 py-4">
  <div class="max-w-6xl mx-auto text-center text-sm text-gray-500">
    Kontakt / Contact: tobias.sjoegreen@gmail.com · Odense · © 2025
  </div>
</footer>

</body>
</html>
